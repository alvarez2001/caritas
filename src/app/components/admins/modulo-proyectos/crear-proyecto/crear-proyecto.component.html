<div [ngClass]="'text-center row'">

    

    <div [ngClass]="'col-12'" >
        <mat-card [ngClass]="'col-md-6 col-lg-4 col-12 mx-auto'">

            <mat-card-subtitle [ngClass]="'alert alert-success'" *ngIf="registro === 'exitoso'">
               Registro exitoso
                <button type="button" [ngClass]="'close'" data-dismiss="alert">&times;</button>
            </mat-card-subtitle>

            <mat-card-subtitle [ngClass]="'alert alert-danger'" *ngIf="registro === 'fallido'">
                Ha ocurrido un error, revise su internet.
                <button type="button" [ngClass]="'close'" data-dismiss="alert">&times;</button>
            </mat-card-subtitle>

            <mat-card-title [ngClass]="'mb-4'">
                Crear un Proyecto
            </mat-card-title>
           
            <div *ngIf="!cargaUser || !cargaAdmin">
                <div [ngClass]="'alert alert-info col-12 mx-auto'" *ngIf="!cargaUser">
                  Cargando todos los usuarios
                </div>
                <div [ngClass]="'alert alert-info col-12 mx-auto'" *ngIf="!cargaAdmin">
                    Cargando todos los administradores
                  </div>
                <p [ngClass]="'text-center'">Cargando...</p>
                <mat-spinner [ngClass]="'mx-auto'"></mat-spinner>
              </div>


            <form action="" [formGroup]="registerProject" (ngSubmit)="register(registerProject)" novalidate *ngIf="cargaUser && cargaAdmin">
                <mat-card-content>
                    

                    
                    <mat-form-field appearance="outline" class="col-12">
                        <mat-label>Nombre del proyecto</mat-label>
                        <input matInput [type]="'text'" autocomplete="off" required formControlName="nombre" [(ngModel)]="proyecto.nombre">
                        <mat-error *ngIf="nombre.invalid"> {{ getErrorMessage(nombre, 'Debe ingresarle un nombre al proyecto', 'Campo valido solo para letras y numeros') }} </mat-error>
                    </mat-form-field>

                    <mat-form-field appearance="outline" class="col-12">
                        <mat-label>Codigo del proyecto</mat-label>
                        <input matInput [type]="'text'" autocomplete="off" required formControlName="codigo" [(ngModel)]="proyecto.codigo">
                        <mat-error *ngIf="codigo.invalid"> {{ getErrorMessage(codigo, 'Debe ingresarle un codigo al proyecto', 'Campo valido solo para letras y numeros') }} </mat-error>
                    </mat-form-field>

                    <mat-form-field appearance="outline" class="col-12">
                        <mat-label>Usuario del proyecto</mat-label> 
                        <mat-select formControlName="usuario_id" required [(ngModel)]="proyecto.usuario_id">
                            <mat-option *ngFor="let solici of solicitantes" [value]="solici.id">
                                {{solici.nombres | titlecase}} {{solici.apellidos | titlecase}}
                            </mat-option>
                        </mat-select>

                        <mat-error *ngIf="usuario_id.invalid"> {{ getErrorMessage(usuario_id, 'Debes ingresar un usuario', 'usuario no valido') }} </mat-error>
                    </mat-form-field>
                    

                    <mat-form-field appearance="outline" class="col-12">
                        <mat-label>Administrador del proyecto</mat-label>
                        <mat-select formControlName="admin_id" required [(ngModel)]="proyecto.admin_id">
                            <mat-option *ngFor="let admin of admins" [value]="admin.id">
                                {{admin.nombres | titlecase}} {{admin.apellidos | titlecase}}
                            </mat-option>
                        </mat-select>

                        <mat-error *ngIf="admin_id.invalid"> {{ getErrorMessage(admin_id, 'Debes ingresar un administrador al proyecto', 'administrador no valido') }} </mat-error>

                        
                    </mat-form-field>

                    <mat-form-field appearance="outline" class="col-12">
                        <mat-label>Monto aprobado del proyecto</mat-label>
                        <input matInput [type]="'number'" step="0.01" placeholder="Ejemplo: 32000,53" autocomplete="off" required formControlName="aprobado" [(ngModel)]="proyecto.aprobado" (keyup)="calcularPorcentaje()">
                        <mat-error *ngIf="aprobado.invalid"> {{ getErrorMessage(aprobado, 'Debe ingresar un monto al proyecto', 'Campo valido solo para numeros') }} </mat-error>
                        <mat-icon  matSuffix matTooltip='Ejemplo: 32000,53  Separar los decimales con la coma ","'>priority_high</mat-icon>

                        <p class="mt-2 mb-0"  >{{proyecto.aprobado | currency:'€ ':true:'1.2'}}</p>
                    </mat-form-field>

                    <mat-form-field appearance="outline" class="col-12">
                        <mat-label>Comision del proyecto</mat-label>
                        <mat-select required formControlName="comision"  [(ngModel)]="comisionInput" (ngModelChange)="calcularPorcentaje()">
                            <mat-option value="0.01">1%</mat-option>
                            <mat-option value="0.02">2%</mat-option>
                            <mat-option value="0.03">3%</mat-option>
                            <mat-option value="0.04">4%</mat-option>
                            <mat-option value="0.05">5%</mat-option>
                            <mat-option value="0.06">6%</mat-option>
                            <mat-option value="0.07">7%</mat-option>
                            <mat-option value="0.08">8%</mat-option>
                            <mat-option value="0.09">9%</mat-option>
                            <mat-option value="0.10">10%</mat-option>
                        </mat-select>
                        <mat-error *ngIf="comision.invalid"> {{ getErrorMessage(comision, 'debe ingresar una comision al proyecto') }} </mat-error>
                        <p class="mt-2 mb-0"  >{{  proyecto.comision | currency:'€ ':true:'1.2'}}</p>
                    </mat-form-field>

                    <mat-form-field appearance="outline" class="col-12">
                        <mat-label>Monto disponible del proyecto</mat-label>
                        <input matInput [type]="'number'" step="0.01" autocomplete="off" readonly required formControlName="disponible" [(ngModel)]="proyecto.disponible">
                        <mat-error *ngIf="disponible.invalid"> {{ getErrorMessage(disponible, 'Debe ingresarle un monto al proyecto', 'Campo valido solo para numeros') }} </mat-error>
                        <p class="mt-2 mb-0"  >{{ proyecto.disponible | currency:'€ ':true:'1.2'}}</p>
                    </mat-form-field>


                </mat-card-content>

                <mat-card-actions class="mb-3">
                    <button mat-raised-button color="primary" [type]="'submit'" [disabled]="!registerProject.valid">Vista Previa</button>
                </mat-card-actions>
            </form>
            

        </mat-card> 

        
        
    </div>



  </div>